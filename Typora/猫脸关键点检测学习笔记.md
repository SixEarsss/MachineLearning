# 猫脸关键点检测学习笔记

### 1.图像归一化和标签归一化：

##### 目的：

图像归一化是为了让网络更容易提取特征，加速训练，并提高模型的稳定性。

标签归一化是为了与网络的输出范围一致，从而使损失函数的计算更加稳定，并避免数值范围过大引起的梯度爆炸或学习效率低下。

##### 代码：

在我的代码中，我将图像归一化后的范围集中在【-2，2】左右，标签归一化到【-1，1】，与网络输出范围一致

### 2.collate_fn函数：

在 PyTorch 中，`collate_fn` 是 `DataLoader` 中的一个参数，用于定义如何将 单个样本即 `Dataset.__getitem__` 的返回值）组合成一个批次（batch）。默认的行为是将数据直接堆叠（如 `torch.stack`），但在一些复杂场景（例如样本尺寸不同或需要特殊处理时），可以通过自定义 `collate_fn` 实现批量数据的灵活处理。

防止数据中出现缺失值或异常（返回None，所以我自定义了这个函数）

### 3.模型中添加的分类器：

因为HRNet经过前向传播后，输出的通常是一个包含大量通道数的特征图，这些特征表示了图像中的各种局部和全局特征，但这些特征图并不能直接用于预测关键点坐标（即回归任务）。

所以我加入了一个新的全连接层（分类器）将这些高维特征图转换为关键点坐标，所以最终的输出是一个包含18个值的向量。

### 4.Dropout层：

一种常用的正则化技术，用于防止深度学习模型中的过拟合。

##### 原理：

1.训练过程中随机丢弃神经元，将p比例的神经元的输出随机设为0，这样每次训练迭代时的网络结构都会有所不同。

2.测试时不丢弃神经元。在测试阶段，Dropout 会被关闭，所有神经元都参与计算。但为了保持与训练时的期望一致，所有神经元的输出会按比例缩放。例如，如果训练时 `p=0.5`，那么测试时每个神经元的输出会乘以 0.5。

### 5.Warm—up:

**Warm-up 策略**指的是在训练的初期，逐渐增加学习率，从一个较小的初始值开始，经过若干步训练后，再达到设定的初始学习率。

避免因初始权重过大导致的梯度爆炸，使训练更稳定。